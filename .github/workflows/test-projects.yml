name: Quick Sanity Check

# Lightweight validation for PRs - deploy.yml handles the real builds
on:
  pull_request:
    branches: [ main ]
  workflow_dispatch:

jobs:
  validate:
    name: Validate Portfolio Structure
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
      with:
        submodules: recursive

    - name: Check portfolio essentials
      run: |
        echo "ðŸ§ª Checking portfolio essentials..."
        
        # Core files
        for file in index.html style.css script.js impressum.html datenschutz.html; do
          [ -f "$file" ] && echo "âœ… $file" || { echo "âŒ $file missing"; exit 1; }
        done
        
        # Project pages
        for page in age-of-max firecastle autune-online albert soundoflvke testomax betterbestie dl4j-graph-explorer; do
          [ -f "projects/${page}.html" ] && echo "âœ… projects/${page}.html" || echo "âš ï¸  projects/${page}.html missing"
        done
        
        # Resource directory
        [ -d "res" ] && echo "âœ… res/" || { echo "âŒ res/ missing"; exit 1; }

    - name: Check submodule structure
      run: |
        echo "ðŸ§ª Checking submodules..."
        
        # TypeScript projects (need package.json for builds)
        for proj in AgeOfMax CasinoIdleSlots BetterBestie dl4j-graph-explorer; do
          if [ -d "$proj" ]; then
            [ -f "$proj/package.json" ] && echo "âœ… $proj/package.json" || echo "âš ï¸  $proj/package.json missing"
          else
            echo "âš ï¸  $proj/ not found"
          fi
        done
        
        # Static projects
        for proj in FireCastle AuTuneOnline TestoMax; do
          [ -d "$proj" ] && echo "âœ… $proj/" || echo "âš ï¸  $proj/ not found"
        done

    - name: Generate summary
      if: always()
      run: |
        echo "# ðŸ“Š Validation Summary" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "Quick sanity check completed. Full builds run on deploy." >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "**Note:** This workflow validates structure only." >> $GITHUB_STEP_SUMMARY
        echo "The deploy.yml workflow performs actual builds and catches build errors." >> $GITHUB_STEP_SUMMARY
